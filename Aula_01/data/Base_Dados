-- EXPLORANDO A BASE DE DADOS

SELECT * FROM CIDADE;

SELECT * FROM ESTADO;

SELECT * FROM IMOVEIS;

SELECT * FROM PROPRIETARIO;


-- CONTANDO A QUANTIDADE DE IMOVEIS.
SELECT COUNT(*) FROM IMOVEIS;

-- FILTRANDO REGISTROS
SELECT AREA
,NUM_QUARTOS
,NUM_BANHEIROS
,VALOR_ALUGUEL
,VALOR_IPTU
FROM IMOVEIS
WHERE NUM_QUARTOS > 2;

--CONTANDO A QUANTIDADE DE IMOVEIS POR CIDADE.
SELECT CODIGO_CIDADE,COUNT(*) AS "QTD" FROM IMOVEIS
GROUP BY CODIGO_CIDADE;


-- UNINDO TABELAS
SELECT CIDADE.nome as 'cidade'
,ESTADO.nome as 'estado'
,IMOVEIS.AREA as 'area'
,IMOVEIS.num_quartos
,IMOVEIS.num_banheiros
,IMOVEIS.num_andares
FROM IMOVEIS INNER JOIN CIDADE
ON IMOVEIS.CODIGO_CIDADE = CIDADE.CODIGO
INNER JOIN ESTADO
ON CIDADE.CODIGO_ESTADO = ESTADO.CODIGO;



-- SELECIONANDO O DATASET FINAL

SELECT CIDADE.NOME as 'cidade'
,ESTADO.NOME as 'estado'
,IMOVEIS.AREA as 'area'
,IMOVEIS.NUM_QUARTOS
,IMOVEIS.NUM_BANHEIROS
,IMOVEIS.NUM_ANDARES
,IMOVEIS.ACEITA_ANIMAIS
,IMOVEIS.MOBILIA
,IMOVEIS.VALOR_ALUGUEL
,IMOVEIS.VALOR_CONDOMINIO
,IMOVEIS.VALOR_IPTU
,IMOVEIS.VALOR_SEGURO_INCENDIO
FROM IMOVEIS INNER JOIN CIDADE
ON IMOVEIS.CODIGO_CIDADE = CIDADE.CODIGO
INNER JOIN ESTADO
ON CIDADE.CODIGO_ESTADO = ESTADO.CODIGO;






